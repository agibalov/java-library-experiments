group 'me.loki2302'
version '1.0-SNAPSHOT'

task wrapper(type: Wrapper) {
  gradleVersion = '3.3'
  distributionUrl = "https://services.gradle.org/distributions/gradle-$gradleVersion-all.zip"
}

apply plugin: 'application'
apply plugin: 'docker'

buildscript {
    repositories {
        mavenCentral()
    }

    dependencies {
        classpath 'se.transmode.gradle:gradle-docker:1.2'
    }
}

sourceCompatibility = 1.8
mainClassName = 'me.loki2302.App'

version = '1.0'

repositories {
    mavenCentral()
}

dependencies {
    testCompile group: 'junit', name: 'junit', version: '4.12'
}

task customDocker(type: Docker) {
    applicationName = 'custom'
    tagVersion = '1.0'

    baseImage = 'aglover/java8-pier'
    addFile "${buildDir}/distributions/docker-app-1.0.tar", '/'
    workingDir '/docker-app-1.0/bin'
    defaultCommand = ['./docker-app']
}

customDocker.dependsOn 'distTar'
